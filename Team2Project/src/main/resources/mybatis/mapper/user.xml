<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
  <mapper namespace="com.Team2Project.WorkWave.model.UserMapper">
  
     <select id="doLogin" resultType="uDTO" parameterType="String">
        select * from users where user_id = #{user_id}
    </select>
    
    <insert id="insertUser" parameterType="uDTO">
        <selectKey keyProperty="user_key" resultType="int" order="BEFORE">
            SELECT user_key_seq.NEXTVAL FROM dual
        </selectKey>
        INSERT INTO users (user_key, user_id, user_pwd, user_name, user_phone, user_email, user_addr, user_birth, user_gender, user_join_date, user_confirm, role, enabled)
        VALUES (#{user_key}, #{user_id}, #{user_pwd}, #{user_name}, #{user_phone}, #{user_email}, #{user_addr}, #{user_birth,jdbcType=DATE}, #{user_gender,jdbcType=VARCHAR}, sysdate, #{user_confirm,jdbcType=VARCHAR}, #{role}, 1)
    </insert>
    
    <update id="updateok" parameterType="uDTO">
        update users set user_pwd = #{user_pwd}, user_email = #{user_email}, user_phone = #{user_phone}, user_addr = #{user_addr} where user_key = #{user_key}
     </update>

   
   <select id="delete" resultType="uDTO" parameterType="String">
   	   SELECT * FROM users WHERE user_id = #{user_id}
   </select>
   
   <delete id="deleteok" parameterType="int">
       DELETE FROM users WHERE user_key = #{user_key}
   </delete>
   
   <select id="applyCnt" resultType="int">
   	   select count(*) from apply where profile_key in (select profile_key from profile where user_key = #{user_key})
   </select>
   
   <select id="applyCheckCnt" resultType="int">
   	   select count(*) from apply where profile_key in (select profile_key from profile where user_key = #{user_key})
	   and APPLY_PROFILE_CHECK = 'Y'
   </select>

  <select id="positionJean" resultType="int">
  	   select count(*) from position where user_key = #{user_key}
  </select>
  
  <select id="interest" resultType="int">
  	   select count(*) from interest where user_key = #{user_key}
  </select>
  
  <select id="findUserIdById" resultType="UserLoginDTO" parameterType="String">
  	   select user_id, user_pwd, role from users where user_id = #{user_id}
  </select>
  
  </mapper>